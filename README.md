    Тестовое задание для разработчика

Есть файл с информацией о продажах в формате xml.

Пояснения к структуре:

Batch - список посылок с уникальным номером BatchID (7 цифр). Соблюдается правило: в одном файле один список.

Invoice - полная информация об одной посылке.

InvoiceOperationNumber, InvoiceOperationDate - уникальный номер (максимум 9 цифр) и дата отправки посылки,

CompanyCode - компания отправитель (4 цифры)

InvoiceData - информация об одном товаре. В каждой посылке может быть минимум 1 максимум 10 различных товаров.

ParcelCode - уникальный код товара (15 символов, только цифры. могут быть лидирующие нули, которые являются
существенными)

ItemQty - количество (максимум 50)

ParcelPrice - цена единицы товара для покупателя ( максимум 90000)

1) Предложите вариант структуры реляционной базы данных размещения этой информации. Необходимо описание таблиц с указанием
   типа и размерности полей, индексы, ключи и т.д.
   В том числе необходимо хранить информацию о GUID файла,
   Должен быть учтен тот факт, что будут часто выполняться следующие поисковые запросы:
   какие товары были в посылке с данным номером (InvoiceOperationNumber)
   в каких посылках и в каком количестве был товар с данным кодом (ParcelCode )
2) Напишите на ruby загрузчик таких файлов в базу данных. Должно быть реализовано следующее:
   вебсервис (на основе Ruby on Rails), принимающий на вход данные в описанном выше формате
   должна осуществляться блокировка повторной обработки одного и того же файла(на основе GUID).
   для для доступа к БД желательно использовать ActiveRecord и описать классы моделей для каждой из таблиц.
   код необходимо сопроводить комментариями
   должны быть быть написаны автоматические тесты для всего функционала.